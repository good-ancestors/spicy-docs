<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spicy Docs</title>
  <style>
    html {
      font-family: sans-serif;
    }
    section {
      max-width: 480px;
      margin: 32px auto;
      padding: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <section>
    <h1>Step 1</h1>
    <p>Enter the document ID and then click download below.</p>
    <input type="text" id="docId" placeholder="e.g. 1dIbbLA3wop7-hBSGVYk11nKqdL-hEO-KrqTeBrx4XXo">
    <button onclick="download()">Download</button>
    <br>
    <br>
    <br>
    <h1>Step 2</h1>
    <p>Upload this downloaded Pick n Mix HTML file here:</p>
    <input type="file" id="htmlFile" accept=".html">
    <br>
    <br>
    <br>
    <h1>Step 3</h1>
    <p>
      Click "Spice-ify" below to pepper in the extra functionality and
      download the document
    </p>
    <button onclick="spicify()">Spice-ify</button>
    <br>
    <br>
    <br>
    <h1>Step 4</h1>
    <p>Open the downloaded document.</p>
  </section>
  <script>
    function download() {
      const docId = document.getElementById("docId").value;
      const a = document.createElement("a");
      a.download = "document.html";
      a.href = `https://docs.google.com/document/d/${docId}/export?format=html`;
      a.click();
    }

    async function spicify() {
      const fileInput = document.getElementById("htmlFile");
      const file = fileInput.files[0];
      const spice = document.getElementById("spice");
      const spiceScript = document.createElement("script");
      spiceScript.innerHTML = atob(spice.innerHTML);
      if (file) {
        try {
          const fileContent = await file.text();
          let doc = new DOMParser().parseFromString(fileContent, "text/html");
          doc.body.appendChild(spiceScript);
          const blob = new Blob([doc.documentElement.outerHTML], {
            type: "text/html;charset=utf-8",
          });
          const a = document.createElement("a");
          a.download = "document.html";
          a.href = URL.createObjectURL(blob);
          a.click();
        } catch (err) {
          console.error("Error reading file:", err);
        }
      } else {
        console.log("No file selected");
      }
    }
  </script>

<template id="spice">bGV0IGgxSGVhZGluZ3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaDEiKTsKbGV0IGgySGVhZGluZ3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaDIiKTsKbGV0IGgzSGVhZGluZ3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaDMiKTsKbGV0IGg0SGVhZGluZ3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaDQiKTsKbGV0IGg1SGVhZGluZ3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaDUiKTsKbGV0IGg2SGVhZGluZ3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaDYiKTsKbGV0IHRhYmxlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0YWJsZSIpOwoKT2JqZWN0LmVudHJpZXModGFibGVzKS5mb3JFYWNoKCh0YWJsZSkgPT4gewogIGNvbnNvbGUubG9nKHRhYmxlWzFdLnBhcmVudE5vZGUpOwogIGxldCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICBkaXYuY2xhc3NMaXN0LmFkZCgiZnVsbC13aWR0aCIpOwogIHRhYmxlWzFdLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRpdiwgdGFibGVbMV0pOwogIGRpdi5hcHBlbmRDaGlsZCh0YWJsZVsxXSk7Cn0pOwoKLy8gSGlkZSBhbGwgY29udGVudCBiZWxvdyBIMSBoZWFkaW5ncwpPYmplY3QuZW50cmllcyhoMUhlYWRpbmdzKS5mb3JFYWNoKChoZWFkaW5nKSA9PiB7CiAgbGV0IG5leHRTaWJsaW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaGVhZGluZ1sxXS5pZCkubmV4dEVsZW1lbnRTaWJsaW5nOwogIGNvbnNvbGUubG9nKG5leHRTaWJsaW5nKTsKICB3aGlsZSAobmV4dFNpYmxpbmcgJiYgbmV4dFNpYmxpbmcubm9kZU5hbWUgIT09ICJIMSIpIHsKICAgIG5leHRTaWJsaW5nLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICBuZXh0U2libGluZyA9IG5leHRTaWJsaW5nLm5leHRFbGVtZW50U2libGluZzsKICB9Cn0pOwoKLy8gTWFrZSBIMSBoZWFkaW5ncyBjbGlja2FibGUKT2JqZWN0LmVudHJpZXMoaDFIZWFkaW5ncykuZm9yRWFjaCgoaGVhZGluZykgPT4gewogIGhlYWRpbmdbMV0uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICBsZXQgbmV4dFNpYmxpbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChoZWFkaW5nWzFdLmlkKS5uZXh0RWxlbWVudFNpYmxpbmc7CiAgICBsZXQgZXhwYW5kZWQgPSBuZXh0U2libGluZy5zdHlsZS5kaXNwbGF5ID09PSAiYmxvY2siOwogICAgbGV0IGNvbnRlbnRJc1VuZGVySDIgPSBmYWxzZTsKICAgIHdoaWxlIChuZXh0U2libGluZyAmJiBuZXh0U2libGluZy5ub2RlTmFtZSAhPT0gIkgxIikgewogICAgICBpZiAoZXhwYW5kZWQpIHsKICAgICAgICBuZXh0U2libGluZy5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICB9IGVsc2UgewogICAgICAgIGlmIChuZXh0U2libGluZy5ub2RlTmFtZSA9PT0gIkgyIikgewogICAgICAgICAgY29udGVudElzVW5kZXJIMiA9IHRydWU7CiAgICAgICAgICBuZXh0U2libGluZy5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICB9CiAgICAgICAgaWYgKCFjb250ZW50SXNVbmRlckgyICYmIG5leHRTaWJsaW5nLm5vZGVOYW1lICE9PSAiU0NSSVBUIikgewogICAgICAgICAgbmV4dFNpYmxpbmcuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgfQogICAgICB9CiAgICAgIG5leHRTaWJsaW5nID0gbmV4dFNpYmxpbmcubmV4dEVsZW1lbnRTaWJsaW5nOwogICAgfQogIH0pOwp9KTsKCi8vIE1ha2UgSDIgaGVhZGluZ3MgY2xpY2thYmxlCk9iamVjdC5lbnRyaWVzKGgySGVhZGluZ3MpLmZvckVhY2goKGhlYWRpbmcpID0+IHsKICBoZWFkaW5nWzFdLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgbGV0IG5leHRTaWJsaW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaGVhZGluZ1sxXS5pZCkubmV4dEVsZW1lbnRTaWJsaW5nOwogICAgbGV0IGNvbnRlbnRJc1VuZGVySDMgPSBmYWxzZTsKICAgIGxldCBleHBhbmRlZCA9IG5leHRTaWJsaW5nLnN0eWxlLmRpc3BsYXkgPT09ICJibG9jayI7CiAgICB3aGlsZSAoCiAgICAgIG5leHRTaWJsaW5nICYmCiAgICAgIG5leHRTaWJsaW5nLm5vZGVOYW1lICE9PSAiSDEiICYmCiAgICAgIG5leHRTaWJsaW5nLm5vZGVOYW1lICE9PSAiSDIiCiAgICApIHsKICAgICAgaWYgKGV4cGFuZGVkKSB7CiAgICAgICAgbmV4dFNpYmxpbmcuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAobmV4dFNpYmxpbmcubm9kZU5hbWUgPT09ICJIMyIpIHsKICAgICAgICAgIGNvbnRlbnRJc1VuZGVySDMgPSB0cnVlOwogICAgICAgICAgbmV4dFNpYmxpbmcuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgfQogICAgICAgIGlmICghY29udGVudElzVW5kZXJIMyAmJiBuZXh0U2libGluZy5ub2RlTmFtZSAhPT0gIlNDUklQVCIpIHsKICAgICAgICAgIG5leHRTaWJsaW5nLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgIH0KICAgICAgfQogICAgICBuZXh0U2libGluZyA9IG5leHRTaWJsaW5nLm5leHRFbGVtZW50U2libGluZzsKICAgIH0KICB9KTsKfSk7CgovLyBNYWtlIEgzIGhlYWRpbmdzIGNsaWNrYWJsZQpPYmplY3QuZW50cmllcyhoM0hlYWRpbmdzKS5mb3JFYWNoKChoZWFkaW5nKSA9PiB7CiAgaGVhZGluZ1sxXS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsKICAgIGxldCBuZXh0U2libGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhlYWRpbmdbMV0uaWQpLm5leHRFbGVtZW50U2libGluZzsKICAgIGxldCBjb250ZW50SXNVbmRlckg0ID0gZmFsc2U7CiAgICBsZXQgZXhwYW5kZWQgPSBuZXh0U2libGluZy5zdHlsZS5kaXNwbGF5ID09PSAiYmxvY2siOwogICAgd2hpbGUgKAogICAgICBuZXh0U2libGluZyAmJgogICAgICBuZXh0U2libGluZy5ub2RlTmFtZSAhPT0gIkgxIiAmJgogICAgICBuZXh0U2libGluZy5ub2RlTmFtZSAhPT0gIkgyIiAmJgogICAgICBuZXh0U2libGluZy5ub2RlTmFtZSAhPT0gIkgzIgogICAgKSB7CiAgICAgIGlmIChleHBhbmRlZCkgewogICAgICAgIG5leHRTaWJsaW5nLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKG5leHRTaWJsaW5nLm5vZGVOYW1lID09PSAiSDQiKSB7CiAgICAgICAgICBjb250ZW50SXNVbmRlckg0ID0gdHJ1ZTsKICAgICAgICAgIG5leHRTaWJsaW5nLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgIH0KICAgICAgICBpZiAoIWNvbnRlbnRJc1VuZGVySDQgJiYgbmV4dFNpYmxpbmcubm9kZU5hbWUgIT09ICJTQ1JJUFQiKSB7CiAgICAgICAgICBuZXh0U2libGluZy5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICB9CiAgICAgIH0KICAgICAgbmV4dFNpYmxpbmcgPSBuZXh0U2libGluZy5uZXh0RWxlbWVudFNpYmxpbmc7CiAgICB9CiAgfSk7Cn0pOwoKLy8gTWFrZSBINCBoZWFkaW5ncyBjbGlja2FibGUKT2JqZWN0LmVudHJpZXMoaDRIZWFkaW5ncykuZm9yRWFjaCgoaGVhZGluZykgPT4gewogIGhlYWRpbmdbMV0uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICBsZXQgbmV4dFNpYmxpbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChoZWFkaW5nWzFdLmlkKS5uZXh0RWxlbWVudFNpYmxpbmc7CiAgICBsZXQgY29udGVudElzVW5kZXJINSA9IGZhbHNlOwogICAgbGV0IGV4cGFuZGVkID0gbmV4dFNpYmxpbmcuc3R5bGUuZGlzcGxheSA9PT0gImJsb2NrIjsKICAgIHdoaWxlICgKICAgICAgbmV4dFNpYmxpbmcgJiYKICAgICAgbmV4dFNpYmxpbmcubm9kZU5hbWUgIT09ICJIMSIgJiYKICAgICAgbmV4dFNpYmxpbmcubm9kZU5hbWUgIT09ICJIMiIgJiYKICAgICAgbmV4dFNpYmxpbmcubm9kZU5hbWUgIT09ICJIMyIgJiYKICAgICAgbmV4dFNpYmxpbmcubm9kZU5hbWUgIT09ICJINCIKICAgICkgewogICAgICBpZiAoZXhwYW5kZWQpIHsKICAgICAgICBuZXh0U2libGluZy5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICB9IGVsc2UgewogICAgICAgIGlmIChuZXh0U2libGluZy5ub2RlTmFtZSA9PT0gIkg1IikgewogICAgICAgICAgLy8gY29udGVudElzVW5kZXJINSA9IHRydWU7IC8vIHNpbmNlIHdlJ3JlIG5vdCBtYWtpbmcgSDUgaGVhZGluZ3MgY2xpY2thYmxlCiAgICAgICAgICBuZXh0U2libGluZy5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICB9CiAgICAgICAgaWYgKCFjb250ZW50SXNVbmRlckg1ICYmIG5leHRTaWJsaW5nLm5vZGVOYW1lICE9PSAiU0NSSVBUIikgewogICAgICAgICAgbmV4dFNpYmxpbmcuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgfQogICAgICB9CiAgICAgIG5leHRTaWJsaW5nID0gbmV4dFNpYmxpbmcubmV4dEVsZW1lbnRTaWJsaW5nOwogICAgfQogIH0pOwp9KTsKCmxldCBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIik7CnN0eWxlLmlubmVySFRNTCA9IGAKYm9keS5kb2MtY29udGVudCB7CiAgcGFkZGluZzogMTZweCA4cHg7CiAgbWFyZ2luOiAwIGF1dG87CiAgbWF4LXdpZHRoOiA3MjBweDsKfQoKLmZ1bGwtd2lkdGggewogIHdpZHRoOiAxMDB2dzsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgbGVmdDogNTAlOwogIHJpZ2h0OiA1MCU7CiAgbWFyZ2luLWxlZnQ6IC01MHZ3OwogIG1hcmdpbi1yaWdodDogLTUwdnc7CiAgb3ZlcmZsb3cteDogc2Nyb2xsOwogIG1hcmdpbi1ib3R0b206IDE2cHg7CiAgbWFyZ2luLXRvcDogMTZweDsKCn0KCnRhYmxlIHsKICB3aWR0aDogOTAlOwp9CgpoMSB7CiAgYmFja2dyb3VuZC1jb2xvcjogIzk0YTNiODsKfQpoMiB7CiAgYmFja2dyb3VuZC1jb2xvcjogI2NiZDVlMTsKfQpoMyB7CiAgYmFja2dyb3VuZC1jb2xvcjogI2UyZThmMDsKfQpoNCB7CiAgYmFja2dyb3VuZC1jb2xvcjogI2YxZjVmOTsKfQoKaDEsIGgyLCBoMywgaDQgewogIGN1cnNvcjogcG9pbnRlcjsKICBib3JkZXItcmFkaXVzOiA4cHg7CiAgcGFkZGluZzogOHB4ICFpbXBvcnRhbnQ7Cn0KYDsKZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7CgpsZXQgbWV0YVRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm1ldGEiKTsKbWV0YVRhZy5zZXRBdHRyaWJ1dGUoIm5hbWUiLCAidmlld3BvcnQiKTsKbWV0YVRhZy5zZXRBdHRyaWJ1dGUoImNvbnRlbnQiLCAid2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCIpOwpkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKG1ldGFUYWcpOw==</template></body></html>